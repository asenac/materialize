cat
(defsource x [int64 int64])
(defsource y [int64 int64])
----
ok

build
(outer_join (get x) (get y) [])
----
----
%0 =
| Get x (u0)

%1 =
| Get y (u1)

%2 =
| OuterJoin %0 %1
----
----

build
(full_outer_join (get x) (get y) [])
----
----
%0 =
| Get x (u0)

%1 =
| Get y (u1)

%2 =
| FulllOuterJoin %0 %1
----
----

build
(outer_join (get x) (get y) [(call_binary eq #0 #2)])
----
----
%0 =
| Get x (u0)

%1 =
| Get y (u1)

%2 =
| OuterJoin %0 %1 (#0 = #2)
----
----

build apply=PredicatePushdown
(filter (outer_join (get x) (get y) [(call_binary eq #0 #2)]) [(call_binary eq #0 1)])
----
----
%0 =
| Get x (u0)
| Filter (#0 = 1)

%1 =
| Get y (u1)

%2 =
| OuterJoin %0 %1 (#0 = #2)
| Filter
----
----

# outer-to-inner join conversion during predicate pushdown
build apply=PredicatePushdown
(filter (outer_join (get x) (get y) [(call_binary eq #0 #2)]) [(call_binary eq #2 1)])
----
----
%0 =
| Get x (u0)

%1 =
| Get y (u1)

%2 =
| Join %0 %1
| | implementation = Unimplemented
| Filter (#0 = #2), (#2 = 1)
----
----

build apply=OuterJoinLowering
(outer_join (get x) (get y) [(call_binary eq #0 #2)])
----
----
%0 =
| Get x (u0)

%1 =
| Get y (u1)

%2 =
| OuterJoin %0 %1 (#0 = #2)
----
----
